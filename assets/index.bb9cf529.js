const z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}};z();class ${constructor(e,i=null){this.items=[],this.compare=i||this.__defaultCompare}push(e){this.items.push(e),this.heapifyUp(this.size-1)}pop(){if(this.size===0)return null;this.__swap(0,this.size-1);const e=this.items.pop();return this.heapifyDown(0),e}peek(){return this.size>0?this.items[0]:null}clear(){this.items.splice(0,this.size)}get size(){return this.items.length}heapifyDown(e){const i=e*2+1,a=e*2+2;if(i>this.size-1)return;let s=i;a<this.size&&this.compare(this.items[i],this.items[a])>0&&(s=a),this.compare(this.items[e],this.items[s])>0&&(this.__swap(e,s),this.heapifyDown(s))}heapifyUp(e){const i=Math.floor((e-1)/2);i>=0&&this.compare(this.items[i],this.items[e])>0&&(this.__swap(e,i),this.heapifyUp(i))}__defaultCompare(e,i){return e===i?0:e>i?1:-1}__swap(e,i){[this.items[e],this.items[i]]=[this.items[i],this.items[e]]}}class V{constructor(e,i,a,s=0){this.weight=a,this.id=`${e}:${i}`,this.x=e,this.y=i,this.actual=1/0,this.heuristic=s}}class C{constructor(e,i,a=!1,s=null){this.M=i,this.N=e,this.diagonals=a,this.matrix=[];for(let o=0;o<e;o++){let l=[];for(let c=0;c<i;c++){let u=0;s&&(u=s(o,c));let d=new V(o,c,parseInt(document.getElementById(`${o}:${c}`).getAttribute("weight")),u);l.push(d)}this.matrix.push(l)}}get(e,i){return 0<=e&&e<this.N&&0<=i&&i<this.M?this.matrix[e][i]:NaN}adjacents(e){let i;this.diagonals?i=[[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1]]:i=[[0,1],[1,0],[-1,0],[0,-1]];let a=[];for(const s of i){let o=this.get(e.x+s[0],e.y+s[1]);a.push(o)}return a}}let L=null;class y{static get state(){return L||(L=new y)}constructor(){this._state={},window.Context=this}get state(){return this._state}set(e,i){this._state[e]=i}get(e){return this._state[e]}}const{state:f}=y,x=()=>{const t=f.get("N"),e=f.get("M"),i=f.get("origin").split(":").map(n=>parseInt(n)),a=f.get("destination").split(":").map(n=>parseInt(n)),s=new C(t,e,!1),o=s.get(i[0],i[1]),l=s.get(a[0],a[1]);o.actual=0,l.visited=!1;const c=new $([],(n,h)=>n.actual==h.actual?0:n.actual>h.actual?1:-1),u=[];let d=o;for(;!l.visited&&d;){for(const n of s.adjacents(d))n.actual>d.actual+n.weight&&(n.actual=d.actual+n.weight,n.lastVisited||(c.push(n),n.lastVisited=d));u.push(d.id),d.visited=!0,d=c.pop()}const g=[];for(d=l.lastVisited;d.id!=o.id;)g.push(d.id),d=d.lastVisited;return[u,g.reverse()]},T=()=>{const t=f.get("N"),e=f.get("M"),i=f.get("origin").split(":").map(n=>parseInt(n)),a=f.get("destination").split(":").map(n=>parseInt(n)),s=new C(t,e,!1,(n,h)=>Math.sqrt((a[0]-n)**2+(a[1]-h)**2)),o=s.get(i[0],i[1]),l=s.get(a[0],a[1]);o.actual=0,l.visited=!1;const c=new $([],(n,h)=>{let N=n.actual+n.heuristic-(h.actual+h.heuristic);return N==0?0:N>0?1:-1}),u=[];let d=o;for(;!l.visited&&d;){for(const n of s.adjacents(d))n.actual+n.heuristic>d.actual+d.heuristic+n.weight&&(n.actual=d.actual+n.weight,n.lastVisited||(c.push(n),n.lastVisited=d));u.push(d.id),d.visited=!0,d=c.pop()}const g=[];for(d=l.lastVisited;d.id!=o.id;)g.push(d.id),d=d.lastVisited;return[u,g.reverse()]},H=()=>{const t=f.get("N"),e=f.get("M"),i=f.get("origin").split(":").map(g=>parseInt(g)),a=f.get("destination").split(":").map(g=>parseInt(g)),s=new C(t,e),o=s.get(i[0],i[1]),l=s.get(a[0],a[1]);o.actual=0,l.visited=!1;const c=[];let u=o;const d=g=>{if(!l.visited){for(const n of s.adjacents(g))if(!n.visited&&n.weight<1/0&&n.id!=o.id){if(n.id==l.id){l.visited=!0;return}if(c.push(n.id),n.visited=!0,d(n),l.visited)return}}};return c.push(u),d(u),console.log(c),[c,c]},{state:p}=y,b=40,I=1,m=(t,e)=>{!t||(t.classList.remove(t.classList[1]),t.classList.add(e))},O=t=>{m(t,"visitados")},W=t=>{m(t,"path")},A=t=>{t.target.setAttribute("weight",I),t.target.setAttribute("style",""),m(t.target,"vacio")},k=t=>{let e=p.get("selectedWeight");t.target.setAttribute("weight",e),e==1/0?m(t.target,"wall"):(m(t.target,"heavy"),t.target.setAttribute("style","background-color: blue; opacity: 1"))};function U(){const t=document.getElementById("grid");let e=window.innerWidth,i=window.innerHeight,a=e/b;a<20&&(a=20);const s=Math.floor(i/a);p.set("N",s),p.set("M",b);const o=`${Math.floor(s/2)}:2`,l=`${Math.floor(s/2)}:${b-3}`;p.set("origin",o),p.set("destination",l),t.innerHTML="";for(let d=0;d<s;d++){const g=document.createElement("tr");for(let n=0;n<b;n++){const h=document.createElement("td");h.classList.add("celda","vacio"),h.setAttribute("id",`${d}:${n}`),h.setAttribute("weight",I),g.appendChild(h)}g.classList.add("fila"),t.appendChild(g)}let c=document.getElementById(o),u=document.getElementById(l);m(c,"origen"),m(u,"destino"),c.setAttribute("draggable",!0),u.setAttribute("draggable",!0)}function M(t){document.getElementById("grilla").childNodes.forEach(e=>{e.childNodes.forEach(i=>{t&&(m(i,"vacio"),i.setAttribute("weight",I)),i.classList.contains("wall")||(m(i,"vacio"),i.setAttribute("weight",I))})}),G(),p.set("isClean",!0)}function G(){let t=document.getElementById(p.get("origin")),e=document.getElementById(p.get("destination"));m(t,"origen"),m(e,"destino"),t.setAttribute("draggable",!0),e.setAttribute("draggable",!0)}let{state:B}=y;function P(t,e){const i=+B.get("speed");let a=0;for(let s=1;s<t.length-1;s++){a+=i;let o=document.getElementById(t[s]);setTimeout(()=>{O(o)},a)}a+=1e3;for(let s=0;s<e.length;s++){let o=document.getElementById(e[s]);setTimeout(()=>{W(o)},a),a+=i}setTimeout(()=>{B.set("animating",!1),B.set("isClean",!1)},a)}const{state:r}=y,D=new Map([["Dijkstra",x],["A*",T],["dfs",H]]);window.addEventListener("load",()=>{r.set("speed",5),r.set("N",0),r.set("M",0),r.set("origin","0:1"),r.set("destination","0:0"),r.set("animating",!1),r.set("isClean",!0),r.set("selectedWeight",5),U();const t=document.getElementById("select-algorithm");D.forEach((e,i)=>{const a=document.createElement("option");a.value=i,a.innerText=i,t.appendChild(a)})});const v=document.getElementById("grid");let w=-1;v.addEventListener("mousedown",t=>{r.get("animating")||t.target.id==r.get("origin")||t.target.id==r.get("destination")||(r.get("isClean")||M(),w=t.button,w==0?k(t):w==2&&A(t))});window.addEventListener("mouseup",()=>{w=-1});v.addEventListener("mouseover",t=>{const e=t.target.id;r.get("animating")||!t.target.classList.contains("celda")||e==r.get("origin")||e==r.get("destination")||w==-1||(w==0?k(t):w==2&&A(t))});document.getElementById("clean-grilla").addEventListener("click",()=>{r.get("animating")||(M(!0),r.set("isClean",!0))});v.addEventListener("contextmenu",t=>{t.preventDefault(),!(r.get("animating")||t.target.id==r.get("origin")||t.target.id==r.get("destination"))&&A(t)});function S(t,e){if(!!t){switch(e){case"origen":let i=document.getElementById(r.get("origin"));i.setAttribute("draggable",!1),cambiarCelda(i,"vacio"),cambiarCelda(t,"origen"),r.set("origin",t.id);break;case"destino":let a=document.getElementById(r.get("destination"));a.setAttribute("draggable",!1),cambiarCelda(a,"vacio"),cambiarCelda(t,"destino"),r.set("destination",t.id);break}t.setAttribute("draggable",!0)}}v.addEventListener("dragstart",t=>{if(!r.get("animating"))if(t.target.id==r.get("origin"))t.dataTransfer.setData("dragging","origen");else if(t.target.id==r.get("destination"))t.dataTransfer.setData("dragging","destino");else return});v.addEventListener("dragenter",t=>{t.preventDefault();const e=t.target.id;r.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==r.get("origin")||e==r.get("destination")||t.target.classList.add("droppable")});v.addEventListener("dragover",t=>{t.preventDefault(),r.get("animating")});v.addEventListener("dragleave",t=>{t.preventDefault(),!(t.target.id==r.get("origin")||t.target.id==r.get("destination"))&&t.target.classList.remove("droppable")});v.addEventListener("drop",t=>{const e=t.target.id;if(r.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==r.get("origin")||e==r.get("destination"))return;const i=t.dataTransfer.getData("dragging");t.target.classList.remove("droppable"),S(t.target,i),r.get("isClean")||j()});document.getElementById("run").addEventListener("click",()=>{j()});function j(){if(r.get("animating"))return;r.set("animating",!0),r.get("isClean")||M();const t=document.getElementById("select-algorithm"),e=D.get(t.value)();if(!e){r.set("animating",!1);return}P(e[0],e[1])}const{state:q}=y,_=document.getElementById("menu-container"),F=document.getElementById("menu-button"),K=["algorithms","grid","terrain","nodes"];F.addEventListener("click",()=>{_.style.display=="none"?_.style.display="block":_.style.display="none"});document.getElementById("menu-options").addEventListener("click",t=>{let e=t.target.id.split("-");!K.includes(e[0])||J(e[0])});let E="algorithms";function J(t){E!=t&&(document.getElementById(`${E}-menu`).style.display="none",document.getElementById(`${t}-menu`).style.display="block",document.getElementById(`${E}-option`).classList.replace("active","inactive"),document.getElementById(`${t}-option`).classList.replace("inactive","active"),E=t)}document.getElementById("algorithm-speed-input").onchange=t=>{q.set("speed",t.target.value)};

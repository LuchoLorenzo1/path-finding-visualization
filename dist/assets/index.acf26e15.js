const N=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function i(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(s){if(s.ep)return;s.ep=!0;const r=i(s);fetch(s.href,r)}};N();class D{constructor(e,i=null){this.items=[],this.compare=i||this.__defaultCompare}push(e){this.items.push(e),this.heapifyUp(this.size-1)}pop(){if(this.size===0)return null;this.__swap(0,this.size-1);const e=this.items.pop();return this.heapifyDown(0),e}peek(){return this.size>0?this.items[0]:null}clear(){this.items.splice(0,this.size)}get size(){return this.items.length}heapifyDown(e){const i=e*2+1,a=e*2+2;if(i>this.size-1)return;let s=i;a<this.size&&this.compare(this.items[i],this.items[a])>0&&(s=a),this.compare(this.items[e],this.items[s])>0&&(this.__swap(e,s),this.heapifyDown(s))}heapifyUp(e){const i=Math.floor((e-1)/2);i>=0&&this.compare(this.items[i],this.items[e])>0&&(this.__swap(e,i),this.heapifyUp(i))}__defaultCompare(e,i){return e===i?0:e>i?1:-1}__swap(e,i){[this.items[e],this.items[i]]=[this.items[i],this.items[e]]}}let L=null;class p{static get state(){return L||(L=new p)}constructor(){this._state={},window.Context=this}get state(){return this._state}set(e,i){this._state[e]=i}get(e){return this._state[e]}}const{state:y}=p;class k{constructor(e,i,a){this.weight=a,this.id=`${e}:${i}`,this.x=e,this.y=i,this.actual=1/0}}class j{constructor(e,i){this.M=i,this.N=e,this.matrix=[];for(let a=0;a<e;a++){let s=[];for(let r=0;r<i;r++){let c=new k(a,r,parseInt(document.getElementById(`${a}:${r}`).getAttribute("weight")));s.push(c)}this.matrix.push(s)}}get(e,i){return 0<=e&&e<this.N&&0<=i&&i<this.M?this.matrix[e][i]:NaN}adjacents(e){let i=[[1,0],[0,1],[-1,0],[0,-1]],a=[];for(const s of i){let r=this.get(e.x+s[0],e.y+s[1]);a.push(r)}return a}}function z(){const t=y.get("N"),e=y.get("M"),i=y.get("origin").split(":").map(l=>parseInt(l)),a=y.get("destination").split(":").map(l=>parseInt(l)),s=new j(t,e),r=s.get(i[0],i[1]),c=s.get(a[0],a[1]);r.actual=0,c.visited=!1;const v=new D([],(l,m)=>l.actual==m.actual?0:l.actual>m.actual?1:-1),w=[];let o=r;for(;!c.visited&&o;){for(const l of s.adjacents(o))l.actual>o.actual+l.weight&&(l.actual=o.actual+l.weight,l.lastVisited||(v.push(l),l.lastVisited=o));w.push(o.id),o.visited=!0,o=v.pop()}const u=[];for(o=c.lastVisited;o.id!=r.id;)u.push(o.id),o=o.lastVisited;return u.push(o.id),[w,u.reverse()]}const{state:h}=p,E=40,_=1;function d(t,e){!t||(t.classList.remove(t.classList[1]),t.classList.add(e))}function T(){const t=document.getElementById("grilla");let e=window.innerWidth,i=window.innerHeight,a=e/E;a<20&&(a=20);const s=Math.floor(i/a);h.set("N",s),h.set("M",E);const r=`${Math.floor(s/2)}:2`,c=`${Math.floor(s/2)}:${E-3}`;h.set("origin",r),h.set("destination",c),t.innerHTML="";for(let o=0;o<s;o++){const u=document.createElement("tr");for(let l=0;l<E;l++){const m=document.createElement("td");m.classList.add("celda","vacio"),m.setAttribute("id",`${o}:${l}`),m.setAttribute("weight",_),u.appendChild(m)}u.classList.add("fila"),t.appendChild(u)}let v=document.getElementById(r),w=document.getElementById(c);d(v,"origen"),d(w,"destino"),v.setAttribute("draggable",!0),w.setAttribute("draggable",!0)}function A(t){document.getElementById("grilla").childNodes.forEach(e=>{e.childNodes.forEach(i=>{t&&(d(i,"vacio"),i.setAttribute("weight",_)),i.classList.contains("wall")||(d(i,"vacio"),i.setAttribute("weight",_))})}),O(),h.set("isClean",!0)}function O(){let t=document.getElementById(h.get("origin")),e=document.getElementById(h.get("destination"));d(t,"origen"),d(e,"destino"),t.setAttribute("draggable",!0),e.setAttribute("draggable",!0)}let{state:I}=p;function H(t,e){const i=+I.get("speed");let a=0;for(let s=1;s<t.length-1;s++){a+=i;let r=document.getElementById(t[s]);setTimeout(()=>{d(r,"visitados")},a)}a+=1e3;for(let s=1;s<e.length;s++){let r=document.getElementById(e[s]);setTimeout(()=>{d(r,"path")},a),a+=i}setTimeout(()=>{I.set("animating",!1),I.set("isClean",!1)},a)}const{state:n}=p,$=1,C=new Map([["Dijkstra",z]]);window.addEventListener("load",()=>{n.set("speed",5),n.set("N",0),n.set("M",0),n.set("origin","0:1"),n.set("destination","0:0"),n.set("animating",!1),n.set("isClean",!0),T();const t=document.getElementById("select-algorithm");C.forEach((e,i)=>{const a=document.createElement("option");a.value=i,a.innerText=i,t.appendChild(a)})});window.addEventListener("click",()=>{});const g=document.getElementById("grilla");let f=-1;g.addEventListener("mousedown",t=>{n.get("animating")||t.target.id==n.get("origin")||t.target.id==n.get("destination")||(n.get("isClean")||A(),f=t.button,f==0?(t.target.setAttribute("weight",1/0),d(t.target,"wall")):f==2&&(t.target.setAttribute("weight",$),d(t.target,"vacio")))});window.addEventListener("mouseup",()=>{f=-1});g.addEventListener("mouseover",t=>{const e=t.target.id;n.get("animating")||!t.target.classList.contains("celda")||e==n.get("origin")||e==n.get("destination")||f==-1||(f==0?(t.target.setAttribute("weight",1/0),d(t.target,"wall")):f==2&&(t.target.setAttribute("weight",$),d(t.target,"vacio")))});document.getElementById("clean-grilla").addEventListener("click",()=>{n.get("animating")||(A(!0),n.set("isClean",!0))});g.addEventListener("contextmenu",t=>{t.preventDefault(),!(n.get("animating")||t.target.id==n.get("origin")||t.target.id==n.get("destination"))&&(t.target.setAttribute("weight",$),d(t.target,"vacio"))});function x(t,e){if(!!t){switch(e){case"origen":let i=document.getElementById(n.get("origin"));i.setAttribute("draggable",!1),d(i,"vacio"),d(t,"origen"),n.set("origin",t.id);break;case"destino":let a=document.getElementById(n.get("destination"));a.setAttribute("draggable",!1),d(a,"vacio"),d(t,"destino"),n.set("destination",t.id);break}t.setAttribute("draggable",!0)}}g.addEventListener("dragstart",t=>{if(!n.get("animating"))if(t.target.id==n.get("origin"))t.dataTransfer.setData("dragging","origen");else if(t.target.id==n.get("destination"))t.dataTransfer.setData("dragging","destino");else return});g.addEventListener("dragenter",t=>{t.preventDefault();const e=t.target.id;n.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==n.get("origin")||e==n.get("destination")||t.target.classList.add("droppable")});g.addEventListener("dragover",t=>{t.preventDefault(),n.get("animating")});g.addEventListener("dragleave",t=>{t.preventDefault(),!(t.target.id==n.get("origin")||t.target.id==n.get("destination"))&&t.target.classList.remove("droppable")});g.addEventListener("drop",t=>{const e=t.target.id;if(n.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==n.get("origin")||e==n.get("destination"))return;const i=t.dataTransfer.getData("dragging");t.target.classList.remove("droppable"),x(t.target,i),n.get("isClean")||M()});document.getElementById("run").addEventListener("click",()=>{M()});function M(){if(n.get("animating"))return;n.set("animating",!0),n.get("isClean")||A();const t=document.getElementById("select-algorithm"),e=C.get(t.value)();if(!e){n.set("animating",!1);return}H(e[0],e[1])}const{state:V}=p,B=document.getElementById("menu-container"),G=document.getElementById("menu-button"),U=["algorithms","grid","terrain","nodes"];G.addEventListener("click",()=>{B.style.display=="none"?B.style.display="block":B.style.display="none"});document.getElementById("menu-options").addEventListener("click",t=>{let e=t.target.id.split("-");!U.includes(e[0])||W(e[0])});let b="algorithms";function W(t){b!=t&&(document.getElementById(`${b}-menu`).style.display="none",document.getElementById(`${t}-menu`).style.display="block",document.getElementById(`${b}-option`).classList.replace("active","inactive"),document.getElementById(`${t}-option`).classList.replace("inactive","active"),b=t)}document.getElementById("algorithm-speed-input").onchange=t=>{V.set("speed",t.target.value)};

const j=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function i(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(s){if(s.ep)return;s.ep=!0;const o=i(s);fetch(s.href,o)}};j();class C{constructor(e,i=null){this.items=[],this.compare=i||this.__defaultCompare}push(e){this.items.push(e),this.heapifyUp(this.size-1)}pop(){if(this.size===0)return null;this.__swap(0,this.size-1);const e=this.items.pop();return this.heapifyDown(0),e}peek(){return this.size>0?this.items[0]:null}clear(){this.items.splice(0,this.size)}get size(){return this.items.length}heapifyDown(e){const i=e*2+1,a=e*2+2;if(i>this.size-1)return;let s=i;a<this.size&&this.compare(this.items[i],this.items[a])>0&&(s=a),this.compare(this.items[e],this.items[s])>0&&(this.__swap(e,s),this.heapifyDown(s))}heapifyUp(e){const i=Math.floor((e-1)/2);i>=0&&this.compare(this.items[i],this.items[e])>0&&(this.__swap(e,i),this.heapifyUp(i))}__defaultCompare(e,i){return e===i?0:e>i?1:-1}__swap(e,i){[this.items[e],this.items[i]]=[this.items[i],this.items[e]]}}class z{constructor(e,i,a,s=0){this.weight=a,this.id=`${e}:${i}`,this.x=e,this.y=i,this.actual=1/0,this.heuristic=s}}class A{constructor(e,i,a=!1,s=null){this.M=i,this.N=e,this.diagonals=a,this.matrix=[];for(let o=0;o<e;o++){let l=[];for(let c=0;c<i;c++){let h=0;s&&(h=s(o,c));let d=new z(o,c,parseInt(document.getElementById(`${o}:${c}`).getAttribute("weight")),h);l.push(d)}this.matrix.push(l)}}get(e,i){return 0<=e&&e<this.N&&0<=i&&i<this.M?this.matrix[e][i]:NaN}adjacents(e){let i;this.diagonals?i=[[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1]]:i=[[0,1],[1,0],[-1,0],[0,-1]];let a=[];for(const s of i){let o=this.get(e.x+s[0],e.y+s[1]);a.push(o)}return a}}let b=null;class y{static get state(){return b||(b=new y)}constructor(){this._state={},window.Context=this}get state(){return this._state}set(e,i){this._state[e]=i}get(e){return this._state[e]}}const{state:m}=y,V=()=>{const t=m.get("N"),e=m.get("M"),i=m.get("origin").split(":").map(n=>parseInt(n)),a=m.get("destination").split(":").map(n=>parseInt(n)),s=new A(t,e,!1),o=s.get(i[0],i[1]),l=s.get(a[0],a[1]);o.actual=0,l.visited=!1;const c=new C([],(n,f)=>n.actual==f.actual?0:n.actual>f.actual?1:-1),h=[];let d=o;for(;!l.visited&&d;){for(const n of s.adjacents(d))n.actual>d.actual+n.weight&&(n.actual=d.actual+n.weight,n.lastVisited||(c.push(n),n.lastVisited=d));h.push(d.id),d.visited=!0,d=c.pop()}const u=[];for(d=l.lastVisited;d.id!=o.id;)u.push(d.id),d=d.lastVisited;return[h,u.reverse()]},x=()=>{const t=m.get("N"),e=m.get("M"),i=m.get("origin").split(":").map(n=>parseInt(n)),a=m.get("destination").split(":").map(n=>parseInt(n)),s=new A(t,e,!1,(n,f)=>Math.sqrt((a[0]-n)**2+(a[1]-f)**2)),o=s.get(i[0],i[1]),l=s.get(a[0],a[1]);o.actual=0,l.visited=!1;const c=new C([],(n,f)=>{let N=n.actual+n.heuristic-(f.actual+f.heuristic);return N==0?0:N>0?1:-1}),h=[];let d=o;for(;!l.visited&&d;){for(const n of s.adjacents(d))n.actual+n.heuristic>d.actual+d.heuristic+n.weight&&(n.actual=d.actual+n.weight,n.lastVisited||(c.push(n),n.lastVisited=d));h.push(d.id),d.visited=!0,d=c.pop()}const u=[];for(d=l.lastVisited;d.id!=o.id;)u.push(d.id),d=d.lastVisited;return[h,u.reverse()]},T=()=>{const t=m.get("N"),e=m.get("M"),i=m.get("origin").split(":").map(u=>parseInt(u)),a=m.get("destination").split(":").map(u=>parseInt(u)),s=new A(t,e),o=s.get(i[0],i[1]),l=s.get(a[0],a[1]);o.actual=0,l.visited=!1;const c=[];let h=o;const d=u=>{if(!l.visited){for(const n of s.adjacents(u))if(!n.visited&&n.weight<1/0&&n.id!=o.id){if(n.id==l.id){l.visited=!0;return}if(c.push(n.id),n.visited=!0,d(n),l.visited)return}}};return c.push(h),d(h),console.log(c),[c,c]},{state:v}=y,E=40,_=1;function g(t,e){!t||(t.classList.remove(t.classList[1]),t.classList.add(e))}function H(){const t=document.getElementById("grilla");let e=window.innerWidth,i=window.innerHeight,a=e/E;a<20&&(a=20);const s=Math.floor(i/a);v.set("N",s),v.set("M",E);const o=`${Math.floor(s/2)}:2`,l=`${Math.floor(s/2)}:${E-3}`;v.set("origin",o),v.set("destination",l),t.innerHTML="";for(let d=0;d<s;d++){const u=document.createElement("tr");for(let n=0;n<E;n++){const f=document.createElement("td");f.classList.add("celda","vacio"),f.setAttribute("id",`${d}:${n}`),f.setAttribute("weight",_),u.appendChild(f)}u.classList.add("fila"),t.appendChild(u)}let c=document.getElementById(o),h=document.getElementById(l);g(c,"origen"),g(h,"destino"),c.setAttribute("draggable",!0),h.setAttribute("draggable",!0)}function M(t){document.getElementById("grilla").childNodes.forEach(e=>{e.childNodes.forEach(i=>{t&&(g(i,"vacio"),i.setAttribute("weight",_)),i.classList.contains("wall")||(g(i,"vacio"),i.setAttribute("weight",_))})}),O(),v.set("isClean",!0)}function O(){let t=document.getElementById(v.get("origin")),e=document.getElementById(v.get("destination"));g(t,"origen"),g(e,"destino"),t.setAttribute("draggable",!0),e.setAttribute("draggable",!0)}let{state:L}=y;function G(t,e){const i=+L.get("speed");let a=0;for(let s=1;s<t.length-1;s++){a+=i;let o=document.getElementById(t[s]);setTimeout(()=>{g(o,"visitados")},a)}a+=1e3;for(let s=0;s<e.length;s++){let o=document.getElementById(e[s]);setTimeout(()=>{g(o,"path")},a),a+=i}setTimeout(()=>{L.set("animating",!1),L.set("isClean",!1)},a)}const{state:r}=y,$=1,k=new Map([["Dijkstra",V],["A*",x],["dfs",T]]);window.addEventListener("load",()=>{r.set("speed",5),r.set("N",0),r.set("M",0),r.set("origin","0:1"),r.set("destination","0:0"),r.set("animating",!1),r.set("isClean",!0),H();const t=document.getElementById("select-algorithm");k.forEach((e,i)=>{const a=document.createElement("option");a.value=i,a.innerText=i,t.appendChild(a)})});window.addEventListener("click",()=>{});const p=document.getElementById("grilla");let w=-1;p.addEventListener("mousedown",t=>{r.get("animating")||t.target.id==r.get("origin")||t.target.id==r.get("destination")||(r.get("isClean")||M(),w=t.button,w==0?(t.target.setAttribute("weight",1/0),g(t.target,"wall")):w==2&&(t.target.setAttribute("weight",$),g(t.target,"vacio")))});window.addEventListener("mouseup",()=>{w=-1});p.addEventListener("mouseover",t=>{const e=t.target.id;r.get("animating")||!t.target.classList.contains("celda")||e==r.get("origin")||e==r.get("destination")||w==-1||(w==0?(t.target.setAttribute("weight",1/0),g(t.target,"wall")):w==2&&(t.target.setAttribute("weight",$),g(t.target,"vacio")))});document.getElementById("clean-grilla").addEventListener("click",()=>{r.get("animating")||(M(!0),r.set("isClean",!0))});p.addEventListener("contextmenu",t=>{t.preventDefault(),!(r.get("animating")||t.target.id==r.get("origin")||t.target.id==r.get("destination"))&&(t.target.setAttribute("weight",$),g(t.target,"vacio"))});function S(t,e){if(!!t){switch(e){case"origen":let i=document.getElementById(r.get("origin"));i.setAttribute("draggable",!1),g(i,"vacio"),g(t,"origen"),r.set("origin",t.id);break;case"destino":let a=document.getElementById(r.get("destination"));a.setAttribute("draggable",!1),g(a,"vacio"),g(t,"destino"),r.set("destination",t.id);break}t.setAttribute("draggable",!0)}}p.addEventListener("dragstart",t=>{if(!r.get("animating"))if(t.target.id==r.get("origin"))t.dataTransfer.setData("dragging","origen");else if(t.target.id==r.get("destination"))t.dataTransfer.setData("dragging","destino");else return});p.addEventListener("dragenter",t=>{t.preventDefault();const e=t.target.id;r.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==r.get("origin")||e==r.get("destination")||t.target.classList.add("droppable")});p.addEventListener("dragover",t=>{t.preventDefault(),r.get("animating")});p.addEventListener("dragleave",t=>{t.preventDefault(),!(t.target.id==r.get("origin")||t.target.id==r.get("destination"))&&t.target.classList.remove("droppable")});p.addEventListener("drop",t=>{const e=t.target.id;if(r.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==r.get("origin")||e==r.get("destination"))return;const i=t.dataTransfer.getData("dragging");t.target.classList.remove("droppable"),S(t.target,i),r.get("isClean")||D()});document.getElementById("run").addEventListener("click",()=>{D()});function D(){if(r.get("animating"))return;r.set("animating",!0),r.get("isClean")||M();const t=document.getElementById("select-algorithm"),e=k.get(t.value)();if(!e){r.set("animating",!1);return}G(e[0],e[1])}const{state:U}=y,B=document.getElementById("menu-container"),W=document.getElementById("menu-button"),q=["algorithms","grid","terrain","nodes"];W.addEventListener("click",()=>{B.style.display=="none"?B.style.display="block":B.style.display="none"});document.getElementById("menu-options").addEventListener("click",t=>{let e=t.target.id.split("-");!q.includes(e[0])||P(e[0])});let I="algorithms";function P(t){I!=t&&(document.getElementById(`${I}-menu`).style.display="none",document.getElementById(`${t}-menu`).style.display="block",document.getElementById(`${I}-option`).classList.replace("active","inactive"),document.getElementById(`${t}-option`).classList.replace("inactive","active"),I=t)}document.getElementById("algorithm-speed-input").onchange=t=>{U.set("speed",t.target.value)};

const D=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerpolicy&&(r.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?r.credentials="include":n.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=a(n);fetch(n.href,r)}};D();let $=null;class v{static get state(){return $||($=new v)}constructor(){this._state={},window.Context=this}get state(){return this._state}set(e,a){this._state[e]=a}get(e){return this._state[e]}}const{state:b}=v;function T(){const t=b.get("N"),e=b.get("M"),a=b.get("origin"),s=b.get("destination"),n=new Map;for(let c=0;c<t;c++)for(let o=0;o<e;o++)n.set(`${c}:${o}`,{peso:document.getElementById(`${c}:${o}`).getAttribute("weight"),actual:1/0,camino:[]});const r=[],l=new Set;l.add(a),n.get(a).actual=0;let d=a;for(;!l.has(s)&&d;){let c=n.get(d),[o,u]=d.split(":");o=parseInt(o),u=parseInt(u);let E=[n.get(`${o+1}:${u}`),n.get(`${o}:${u+1}`),n.get(`${o-1}:${u}`),n.get(`${o}:${u-1}`)];for(const p of E)!p||c.actual+p.peso<p.actual&&(p.actual=c.actual+p.peso,p.camino=[...c.camino],p.camino.push(d));l.add(d),r.push(d),d=j(l,n)}let f=n.get(s);return f.camino.length==0?(alert("es imposible llegar a destino"),null):[r,f.camino]}function j(t,e){let a=1/0,s;for(const n of t){let r=e.get(n),[l,d]=n.split(":");l=parseInt(l),d=parseInt(d);let f=[`${l+1}:${d}`,`${l}:${d+1}`,`${l-1}:${d}`,`${l}:${d-1}`];for(const c of f){let o=e.get(c);!o||t.has(c)||r.actual+o.peso<a&&(a=r.actual+o.peso,s=c)}}return s}const{state:h}=v,w=40,A=1;function g(t,e){!t||(t.classList.remove(t.classList[1]),t.classList.add(e))}function O(){const t=document.getElementById("grilla");let e=window.innerWidth,a=window.innerHeight,s=e/w;s<20&&(s=20);const n=Math.floor(a/s);h.set("N",n),h.set("M",w);const r=`${Math.floor(n/2)}:2`,l=`${Math.floor(n/2)}:${w-3}`;h.set("origin",r),h.set("destination",l),t.innerHTML="";for(let c=0;c<n;c++){const o=document.createElement("tr");for(let u=0;u<w;u++){const E=document.createElement("td");E.classList.add("celda","vacio"),E.setAttribute("id",`${c}:${u}`),E.setAttribute("weight",A),o.appendChild(E)}o.classList.add("fila"),t.appendChild(o)}let d=document.getElementById(r),f=document.getElementById(l);g(d,"origen"),g(f,"destino"),d.setAttribute("draggable",!0),f.setAttribute("draggable",!0)}function C(t){document.getElementById("grilla").childNodes.forEach(e=>{e.childNodes.forEach(a=>{t&&(g(a,"vacio"),a.setAttribute("weight",A)),a.classList.contains("wall")||(g(a,"vacio"),a.setAttribute("weight",A))})}),x(),h.set("isClean",!0)}function x(){let t=document.getElementById(h.get("origin")),e=document.getElementById(h.get("destination"));g(t,"origen"),g(e,"destino"),t.setAttribute("draggable",!0),e.setAttribute("draggable",!0)}let{state:I}=v;function _(t,e){const a=+I.get("speed");let s=0;for(let n=1;n<t.length-1;n++){s+=a;let r=document.getElementById(t[n]);setTimeout(()=>{g(r,"visitados")},s)}s+=1e3;for(let n=1;n<e.length;n++){let r=document.getElementById(e[n]);setTimeout(()=>{g(r,"path")},s),s+=a}setTimeout(()=>{I.set("animating",!1),I.set("isClean",!1)},s)}const{state:i}=v,M=1,k=new Map([["Dijkstra",T]]);window.addEventListener("load",()=>{i.set("speed",5),i.set("N",0),i.set("M",0),i.set("origin","0:1"),i.set("destination","0:0"),i.set("animating",!1),i.set("isClean",!0),O();const t=document.getElementById("select-algorithm");k.forEach((e,a)=>{const s=document.createElement("option");s.value=a,s.innerText=a,t.appendChild(s)})});window.addEventListener("click",()=>{});const m=document.getElementById("grilla");let y=-1;m.addEventListener("mousedown",t=>{i.get("animating")||t.target.id==i.get("origin")||t.target.id==i.get("destination")||(i.get("isClean")||C(),y=t.button,y==0?(t.target.setAttribute("weight",1/0),g(t.target,"wall")):y==2&&(t.target.setAttribute("weight",M),g(t.target,"vacio")))});window.addEventListener("mouseup",()=>{y=-1});m.addEventListener("mouseover",t=>{const e=t.target.id;i.get("animating")||!t.target.classList.contains("celda")||e==i.get("origin")||e==i.get("destination")||y==-1||(y==0?(t.target.setAttribute("weight",1/0),g(t.target,"wall")):y==2&&(t.target.setAttribute("weight",M),g(t.target,"vacio")))});document.getElementById("clean-grilla").addEventListener("click",()=>{i.get("animating")||(C(!0),i.set("isClean",!0))});m.addEventListener("contextmenu",t=>{t.preventDefault(),!(i.get("animating")||t.target.id==i.get("origin")||t.target.id==i.get("destination"))&&(t.target.setAttribute("weight",M),g(t.target,"vacio"))});function H(t,e){if(!!t){switch(e){case"origen":let a=document.getElementById(i.get("origin"));a.setAttribute("draggable",!1),g(a,"vacio"),g(t,"origen"),i.set("origin",t.id);break;case"destino":let s=document.getElementById(i.get("destination"));s.setAttribute("draggable",!1),g(s,"vacio"),g(t,"destino"),i.set("destination",t.id);break}t.setAttribute("draggable",!0)}}m.addEventListener("dragstart",t=>{if(!i.get("animating"))if(t.target.id==i.get("origin"))t.dataTransfer.setData("dragging","origen");else if(t.target.id==i.get("destination"))t.dataTransfer.setData("dragging","destino");else return});m.addEventListener("dragenter",t=>{t.preventDefault();const e=t.target.id;i.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==i.get("origin")||e==i.get("destination")||t.target.classList.add("droppable")});m.addEventListener("dragover",t=>{t.preventDefault(),i.get("animating")});m.addEventListener("dragleave",t=>{t.preventDefault(),!(t.target.id==i.get("origin")||t.target.id==i.get("destination"))&&t.target.classList.remove("droppable")});m.addEventListener("drop",t=>{const e=t.target.id;if(i.get("animating")||t.target.classList.contains("wall")||!t.target.classList.contains("celda")||e==i.get("origin")||e==i.get("destination"))return;const a=t.dataTransfer.getData("dragging");t.target.classList.remove("droppable"),H(t.target,a),i.get("isClean")||N()});document.getElementById("run").addEventListener("click",()=>{N()});function N(){if(i.get("animating"))return;i.set("animating",!0),i.get("isClean")||C();const t=document.getElementById("select-algorithm"),e=k.get(t.value)();if(!e){i.set("animating",!1);return}_(e[0],e[1])}const{state:S}=v,B=document.getElementById("menu-container"),W=document.getElementById("menu-button"),G=["algorithms","grid","terrain","nodes"];W.addEventListener("click",()=>{B.style.display=="none"?B.style.display="block":B.style.display="none"});document.getElementById("menu-options").addEventListener("click",t=>{let e=t.target.id.split("-");!G.includes(e[0])||P(e[0])});let L="algorithms";function P(t){L!=t&&(document.getElementById(`${L}-menu`).style.display="none",document.getElementById(`${t}-menu`).style.display="block",document.getElementById(`${L}-option`).classList.replace("active","inactive"),document.getElementById(`${t}-option`).classList.replace("inactive","active"),L=t)}document.getElementById("algorithm-speed-input").onchange=t=>{S.set("speed",t.target.value)};
